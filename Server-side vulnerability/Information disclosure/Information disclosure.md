## Common sources of information disclosure
Thông tin nhạy cảm có thể bị lộ từ nhiều vị trí khác nhau trên website. Các nguồn thường gặp:
- **Files cho web crawlers** (robots.txt, sitemap.xml)  
	Nhiều website có file **/robots.txt** và **/sitemap.xml** để hỗ trợ crawler. Các file này đôi khi liệt kê thư mục nhạy cảm cần bỏ qua, nên dù không xuất hiện trong site map, bạn vẫn nên truy cập thủ công để tìm thông tin hữu ích.
 
- **Directory listings (liệt kê thư mục)**  
 
- **Developer comments** (comment trong mã nguồn HTML/JS)  

- **[[Solution Information disclosure labs#Information disclosure in error messages|Error messages (thông báo lỗi)]]**
	1. **Tiết lộ về dữ liệu/kiểu input**
	    - Error có thể cho biết parameter cần kiểu dữ liệu gì (số, chuỗi, định dạng đặc biệt...).
	    - Giúp bạn thu hẹp hướng tấn công, tránh thử payload không có tác dụng.
	2. **Tiết lộ công nghệ & phiên bản**
	    - Error đôi khi lộ tên framework, template engine, database, server kèm version.
	    - Từ đó bạn có thể tra cứu exploit public hoặc lỗi config mặc định.
	3. **Nếu là open-source framework**
	    - Có thể đọc source code public để tìm bug và tự viết exploit.
	4. **So sánh sự khác nhau của error messages**
	    - Lỗi khác nhau trong cùng một flow có thể tiết lộ hành vi ẩn phía backend.
	    - Đây là kỹ thuật quan trọng trong nhiều tấn công như **SQLi**, **username enumeration**, v.v.

- **[[Solution Information disclosure labs#Information disclosure on debug page]]** 

- **User account pages**
	Trang hồ sơ hoặc trang tài khoản người dùng thường chứa dữ liệu nhạy cảm như email, số điện thoại, API key,... Về cơ bản, người dùng chỉ có thể xem thông tin của chính họ, nên điều này không phải lỗ hổng. Tuy nhiên, một số website mắc lỗi logic khi xử lý tham số để xác định user. Ví dụ, trang `/user/personal-info?user=carlos` có thể cho phép attacker đổi giá trị `user` để truy cập dữ liệu của người khác. Trong nhiều trường hợp, attacker không lấy được toàn bộ trang, nhưng có thể khai thác lỗ hổng kiểm tra không chặt để đọc riêng lẻ các trường thông tin (như email). Đây chính là một dạng **access control flaw** hay **IDOR**.

- **[[Solution Information disclosure labs#Source code disclosure via backup files|Backup file]]**
	Việc truy cập được vào mã nguồn giúp attacker phân tích hành vi ứng dụng dễ dàng hơn, từ đó xây dựng các cuộc tấn công nghiêm trọng hơn.  
	**Hard-coded sensitive data**
	Đôi khi dữ liệu nhạy cảm được mã hóa cứng trong mã nguồn:
	- API keys  
	- Thông tin xác thực (credentials) để truy cập DB hoặc hệ thống nội bộ  
	**Open-source code**
	Nếu ứng dụng dùng công nghệ mã nguồn mở, attacker có thể tiếp cận một phần mã nguồn thông qua kho lưu trữ công khai. Việc này hỗ trợ phân tích và tìm lỗ hổng.
	Lộ mã nguồn do lỗi cấu hình / sơ suất
	- Một số website có thể vô tình tiết lộ chính mã nguồn của chúng.  
	- Khi mapping website, có thể phát hiện các tệp mã nguồn được tham chiếu trong URL/HTML.  
	- Thay vì thực thi (ví dụ PHP), nếu server bị lỗi cấu hình, nó có thể trả về nội dung thô.
	**Backup / temporary files**
	Nhiều trình soạn thảo sinh file tạm hoặc backup khi chỉnh sửa:
	- `index.php~` (dấu ngã ~ ở cuối)  
	- `index.php.bak`, `index.php.old`, `index.php.txt`, …  
	Nếu server không bảo vệ cẩn thận, gửi request tới các file này có thể trả về **mã nguồn gốc** của ứng dụng.
	- Insecure configuration (cấu hình kém an toàn)
	- Version control history (lịch sử Git/SVN)

- **[[Solution Information disclosure labs#Authentication bypass via information disclosure|Information disclosure due to insecure configuration]]**
	1.  Nguyên nhân phổ biến:
		- Sử dụng công nghệ bên thứ ba với nhiều tùy chọn cấu hình phức tạp → dev/ops không hiểu hết
		- Quên tắt **debug mode** khi triển khai production.
		- Ví dụ: HTTP TRACE
			- Khi bật, server sẽ phản hồi bằng cách **echo lại toàn bộ request**.
			- Rủi ro:
				- Nếu request đi qua reverse proxy, có thể kèm thêm **internal authentication headers**.
				- TRACE sẽ phản chiếu cả những header này → **lộ thông tin nhạy cảm**.

-  [[Solution Information disclosure labs#Information disclosure in version control history|Version control]]
	- Website thường dùng Git, dữ liệu version control lưu trong thư mục **.git**.  
	- Nếu **.git** bị public trên production → có thể truy cập trực tiếp qua `/.git`.  
	- Có thể tải toàn bộ thư mục `.git` về, rồi dùng Git local để xem **lịch sử commit**, **diff**, log thay đổi.  
	- Thường không lấy được full source code, nhưng diff vẫn tiết lộ **snippet code** hoặc **dữ liệu nhạy cảm hard-coded** (API keys, credentials).  