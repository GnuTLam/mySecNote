## Cheat Sheat
```Content Discovery
1
2
3
1.txt
2.txt
ai
api
accountapi
account-api
account_api
chat
history
help
helpline
halpline
hal
avatars
avatar
cgi-bin
phpinfo
/cgi-bin/phpinfo.php
phpinfo.php
cross
crossdomain
crossdomain.xml
domain
customtemplate
CustomTemplate.php
/libs/CustomTemplate.php
libs
lib
sitemap.xml
sitemap
info
pragma
ProductTemplate
ProductTemplate.java.bak
infoleak
leak
bypass
robots.txt
robots
robot
dev
development
tst
prd
prod
test
backup
/backup
.git
/.git/
invalid
authentication
admin-roles
attack
attacker
hack
hacker
hackers
java
AccessTokenUser.java
/backup/AccessTokenUser.java
ProductTemplate.java
/backup/ProductTemplate.java
/backup/ProductTemplate.java.bak
/post/comment/confirmation.zip
confirmation.zip
confirmation.bak
administrator-panel
administrator_panel
administratorpanel
/admin_panel/update_forgot_email/
update_forgot_email
confirmation.0
confirmation.old
confirmation.-old
backup.zip
source.zip
code.zip
secrets.zip
password.zip
info.zip
path
nextproduct
/admin
role-selector
roleselector
role
roles
selector
X-Custom-IP-Authorization: 127.0.0.1
localhost
trace
TRACE
hello
log_in
administrator
admin.conf
js
/resources/js/tracking.js
/resources/js/downloadReport.js
/resources/js/changeEmail.js
/resources/js/searchResults.js
/resources/js/stockCheck.js
/resources/js/xmlStockCheckPayload.js
xmlStockCheckPayload.js
stockCheck.js
stock
settings
setting
debug
searchResults.js
searchResults
downloadReport.js
downloadReport
download
download-transcript
transcript
load
loadimage
report
save-report
save_report
savereport
report.pdf
tracking.js
isloggedin
password
username
sign
sign-in
signin
sign_in
sign-out
sign_out
logout
logoff
comment
reg
registration
register
new
blog
posts
account
my-account
my_account
my-account-details
my_account_details
myaccount
myaccountdetails
myaccountdetail
my-account-details/change-email
my-account-details/update-email
new-password
new_password
refresh
version
ver
v1
v2
back
refreshpassword
refresh_password
refresh-password
post
resources
resource
image
images
/resources/images/tracker.gif
third-party
login
log-in
exploit
upload
files
productID
search_term
search-term
searchterm
term
searchadvanced
tracker
tracker.gif
id
email
mail
log
logs
page
forgot
forgot-password
forgotpassword
forgot_password
advance
adv
advanced
search
search_advanced
filteredsearch
filter
lookup
admin_panel
admin-panel
import
adminpanel
user_import
/admin_panel/user_import
admin_control
admincontrols
admin-controls
admin_controls
control
controls
admin
admins
deliver-to-victim
imagefile
blog_images
blog_image
/admin_controls/metrics/admin-image/
/admin_controls/metrics/blog_images/
/metrics/admin-image/
metrics
submit
metric
exam
apps
app
strut
struts
del
james
kettle
delete
apache
Apache
bscp
blog-image
blogimage
blog_image
admin-image
admin_image
adminimage
change
change-email
change_email
change-password
change_password
changepassword
changeemail
changeemail.js
update
patch
update-email
updateemail
update_email
users
add_users
removeuser
remove-user
remove_user
secret
secretkey
secret_key
home
carlos
product
productcatalog
products
/image/productcatalog/products/
Burp
Suite
Certified
Practitioner
all-labs
```
## Information disclosure in error messages
Trigger lỗi thông qua việc thay đổi `/product?productId=a`.
Response:
```
HTTP/2 500 Internal Server Error
Content-Length: 1682

Internal Server Error: java.lang.NumberFormatException: For input string: "a"
	at java.base/java.lang.NumberFormatException.forInputString(NumberFormatException.java:67)
	at java.base/java.lang.Integer.parseInt(Integer.java:661)
	at java.base/java.lang.Integer.parseInt(Integer.java:777)
	at lab.c.w.x.y.Z(Unknown Source)
	at lab.o.go.g.z.h(Unknown Source)
	at lab.o.go.i.z.p.E(Unknown Source)
	at lab.o.go.i.e.lambda$handleSubRequest$0(Unknown Source)
	at s.x.s.t.lambda$null$3(Unknown Source)
	at s.x.s.t.N(Unknown Source)
	at s.x.s.t.lambda$uncheckedFunction$4(Unknown Source)
	at java.base/java.util.Optional.map(Optional.java:260)
	at lab.o.go.i.e.y(Unknown Source)
	at lab.server.k.a.n.l(Unknown Source)
	at lab.o.go.v.B(Unknown Source)
	at lab.o.go.v.l(Unknown Source)
	at lab.server.k.a.k.p.B(Unknown Source)
	at lab.server.k.a.k.b.lambda$handle$0(Unknown Source)
	at lab.c.t.z.p.Q(Unknown Source)
	at lab.server.k.a.k.b.Q(Unknown Source)
	at lab.server.k.a.r.V(Unknown Source)
	at s.x.s.t.lambda$null$3(Unknown Source)
	at s.x.s.t.N(Unknown Source)
	at s.x.s.t.lambda$uncheckedFunction$4(Unknown Source)
	at lab.server.gv.B(Unknown Source)
	at lab.server.k.a.r.G(Unknown Source)
	at lab.server.k.w.c.q(Unknown Source)
	at lab.server.k.q.m(Unknown Source)
	at lab.server.k.c.m(Unknown Source)
	at lab.server.gd.F(Unknown Source)
	at lab.server.gd.r(Unknown Source)
	at lab.x.e.lambda$consume$0(Unknown Source)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1144)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:642)
	at java.base/java.lang.Thread.run(Thread.java:1583)

Apache Struts 2 2.3.31
```

## Information disclosure on debug page
Sử dụng wordlist của `common.txt` để có thể fuzz các đường dẫn ( Content discovery).
-> Tìm thấy `cgi-bin`. Truy cập vào và kiếm thông tin.
## Source code disclosure via backup files
Sử dụng wordlist của `common.txt` để có thể fuzz các đường dẫn ( Content discovery).
-> Tìm thấy `/backup`. Truy cập vào và kiếm thông tin.
## Authentication bypass via information disclosure
Sử dụng wordlist của `common.txt` để có thể fuzz các đường dẫn ( Content discovery).
-> Tìm thấy `/admin`. Truy cập vào thì thấy thông báo `Admin interface only available to local users`. Sử dụng TRACE để debug gói tin request và phát hiện ra có trường `X-Custom-Ip-Authorization`. Cho giá trị `X-Custom-Ip-Authorization: 127.0.0.1` để bypass.
## Information disclosure in version control history
Fuzz được `/.git`. Dump lại lấy dữ liệu của git và đọc.
```ps1
wget -r https://TARGET.web-security-academy.net/.git/
git-cola --repo 0ad900ad039b4591c0a4f91b00a600e7.web-security-academy.net/
```
Thay vì dùng git-cola có thể dùng chính vscode extension để đọc. Lệnh dưới đây để copy từ máy ảo ra ngoài máy thật 
```
scp user@<VM_IP>:/path/to/file C:\Users\<you>\Desktop\
```