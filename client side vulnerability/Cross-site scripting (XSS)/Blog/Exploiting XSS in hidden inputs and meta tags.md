 ---
- **Published:** 11 July 2023 at 13:00 UTC
- **Updated:** 11 July 2023 at 13:00 UTC
- Source: [Exploiting XSS in hidden inputs and meta tags | PortSwigger Research](https://portswigger.net/research/exploiting-xss-in-hidden-inputs-and-meta-tags)

### Introduction
Tính năng mới của trình duyệt gọi là [popover](https://developer.chrome.com/blog/introducing-popover-api?hl=vi) cho phép đánh dấu một phần tử bằng thuộc tính `popover` để nó bị ẩn cho tới khi được bật bởi một trigger có `popovertarget` (ví dụ: `button`). Với popover bạn có thể dùng hai sự kiện liên quan là `onbeforetoggle` (chạy **trước** khi popover mở/đóng) và `ontoggle` (chạy **sau** khi trạng thái thay đổi).
Điều hay ho là `onbeforetoggle` thường khó có thể bị chặn trên blacklist thuộc tính
```html
<button popovertarget=x>Click me</button>
<xss onbeforetoggle=alert(1) popover id=x>XSS</xss>
```
### XSS in hidden input
Popover có thể hoạt động với input `hidden` -> Điều này quan trọng vì trước đây XSS nằm trong `input type="hidden"` khó khai thác và hầu hết event không kích hoạt được 
```html
<button popovertarget=x>Click me</button>
<input type="hidden" value="y" popover id=x onbeforetoggle=alert(1)>
```
Ta có thể thấy chúng ta cần 2 điểm để injection XSS. Thứ nhất sẽ là `<buton ...>` và điểm còn lại sẽ có thuộc tính trigger xss. 